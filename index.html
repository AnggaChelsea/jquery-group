<!DOCTYPE html>
<html>
<head>
<meta name="description" content="jQuery plugin for tournament group stages" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<script type="text/javascript" src="lib/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="lib/Bacon-1ab32ffb.min.js"></script>
<script type="text/javascript" src="lib/lodash-v1.0.0-rc.3.min.js"></script>
<script type="text/javascript" src="lib/live.js"></script>
<script type="text/javascript" src="lib/handlebars-1.0.rc.2.js"></script>
<script type="text/javascript" src="jquery.group.js"></script>
<link type="text/css" rel="stylesheet" href="jquery.group.css" />
<style>
body { padding: 1%; }
pre { background-color: #EEE; max-height: 500px; overflow-y: scroll; }
#data { float: right; width: 28%; margin-left: 2%; }
#components { float: left; width: 68%; margin-right: 2%; }
#view { -moz-transition: all 0.5s; -webkit-transition: all 0.5s; }
</style>
<script type='text/javascript'>
$(function() {
  function changeCallback(state) {
    $('pre').text(JSON.stringify(state, undefined, 2))

    // Update read-only version of the component
    $('#view').empty().group({ pairs: pairs.value(), init: state })
  }

  var participants = _(["Red Tornadoes", "Venomous Planets", "Crimson Legends", "Deadly Slammers"])
  var roundCount = participants.size() - 1 + (participants.size() % 2)
  var pairs = participants.map(function(it, i) {
    return participants.filter(function(_, j) { return j < i }).map(function(it2) {
      return { round: ~~(Math.random()*10)%roundCount,
              a: { name: it,  score: ~~(Math.random()*10)%10 },
              b: { name: it2, score: ~~(Math.random()*10)%10 } }
    }).value()
  }).flatten(true)

  $('#editor').group({ pairs: pairs.value(), onchange: changeCallback })
})
</script>
<title>jQuery group</title>
<script type='text/javascript'>
  //<![CDATA[
  if (window.location.host != "localhost") {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1488867-1']);
    _gaq.push(['_trackPageview']);
    (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  }
  //]]>
</script>
<script type='text/javascript'>
$(function() {
  var $container = $('#view')
  Bacon.repeatedly(1000, [200, 400, 600, 800]).onValue(function(length) {
    $container.css('width', length)
  })
})
</script>
</head>
<body>
<h1>Round-robin tournament group editor</h1>
<div id="data">
  <h2>State</h2>
  <pre id="state"></pre>
</div>
<div id="components">
  <h2>Editor ("read-write")</h2>
  <div id="editor"></div>
  <h2>View ("read-only")</h2>
  <div id="view"></div>
</div>
</body>
</html>
